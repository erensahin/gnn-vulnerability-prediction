""" init module to set up configuration """

import os
import yaml

CONFIG_PATH = os.path.join(os.path.dirname(__file__), "config")

with open(os.path.join(CONFIG_PATH, 'config.yaml'), 'r') as f:
    try:
        CONFIG = yaml.safe_load(f)
    except yaml.YAMLError as ex:
        print(ex)

REPOS_PATH = CONFIG['REPOS_PATH']
LLVM_PATH = CONFIG["LLVM_PATH"]
OUTPUT_DIR = os.path.abspath(os.path.join(
    os.path.dirname(__file__), "..", "output"))

AST_OUTPUT_DIR = os.path.join(OUTPUT_DIR, "ast")
LOG_DIR = os.path.join(OUTPUT_DIR, "logs")


REPOS = {
    "wireshark": {
        "path": os.path.join(REPOS_PATH, "wireshark"),
        "output_dir": os.path.join(OUTPUT_DIR, "wireshark"),
        "ast_output_dir": os.path.join(AST_OUTPUT_DIR, "wireshark")
    }
}

if not os.path.isdir(OUTPUT_DIR):
    os.makedirs(OUTPUT_DIR)

if not os.path.isdir(AST_OUTPUT_DIR):
    os.makedirs(AST_OUTPUT_DIR)

if not os.path.isdir(LOG_DIR):
    os.makedirs(LOG_DIR)

for repo in REPOS:
    if not os.path.isdir(REPOS[repo]["output_dir"]):
        os.makedirs(REPOS[repo]["output_dir"])

    if not os.path.isdir(REPOS[repo]["ast_output_dir"]):
        os.makedirs(REPOS[repo]["ast_output_dir"])
